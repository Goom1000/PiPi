# Milestone v3.1: Teleprompter Verbosity

**Status:** SHIPPED 2026-01-25
**Phases:** 27-28
**Total Plans:** 3

## Overview

Add a three-level verbosity toggle to the teleprompter panel, allowing teachers to switch between Concise, Standard, and Detailed scripts mid-lesson. Generated scripts are cached per slide for instant switching, with cache persistence in presentation state.

## Phases

### Phase 27: Verbosity UI & Generation

**Goal**: Teacher can select verbosity level and see appropriately styled teleprompter content

**Depends on**: None (builds on existing teleprompter infrastructure)

**Plans**: 2 plans

Plans:
- [x] 27-01: Add verbosity-aware teleprompter regeneration to AI service layer
- [x] 27-02: Add verbosity selector UI to teleprompter panel

**Requirements:**
- VERB-01: Teacher can see three verbosity levels (Concise / Standard / Detailed) in teleprompter panel
- VERB-02: Verbosity selector appears at top of teleprompter panel (below existing icons)
- VERB-03: Current verbosity level is visually highlighted
- VERB-04: Switching verbosity shows loading indicator while regenerating
- VERB-05: Concise mode produces very brief sentences (minimal guidance)
- VERB-06: Standard mode produces current balanced scripts (existing behavior, default)
- VERB-07: Detailed mode produces full sentences with transitions (script-like, read verbatim)
- VERB-08: Teleprompter regenerates on-demand when verbosity changed

**Details:**
- VerbosityLevel type exported from geminiService.ts for UI consumption
- regenerateTeleprompter method on AIProviderInterface
- TELEPROMPTER_RULES_CONCISE and TELEPROMPTER_RULES_DETAILED constants
- Both Gemini and Claude providers implement verbosity-aware regeneration
- Three-button verbosity selector in PresentationView.tsx
- Loading spinner and overlay during regeneration
- Automatic reset to Standard on slide change (later changed in Phase 28)

---

### Phase 28: Caching & Backward Compatibility

**Goal**: Verbosity selections persist and switch instantly when previously generated

**Depends on**: Phase 27 (UI and generation must work first)

**Plans**: 1 plan

Plans:
- [x] 28-01: Add per-slide verbosity caching with file format support

**Requirements:**
- VERB-09: Generated versions are cached per slide (instant switch-back)
- VERB-10: Cache persists in presentation state (survives refresh)
- VERB-11: Existing presentations default to Standard verbosity
- VERB-12: .cue/.pipi file format supports verbosity cache storage

**Details:**
- Slide.verbosityCache optional property in types.ts
- CURRENT_FILE_VERSION bumped to 2
- v1->v2 migration case in loadService.ts (no-op for optional field)
- Cache-aware handleVerbosityChange with instant switch-back
- Navigation persistence via useEffect
- Cache invalidation in handleUpdateSlide when content changes

---

## Milestone Summary

**Key Decisions:**
- Verbosity levels: concise (bullet-point prompts), standard (existing), detailed (full script)
- Standard verbosity uses existing TELEPROMPTER_RULES for backward compatibility
- Cache only concise/detailed (standard uses speakerNotes directly)
- Clear cache when content or title changes (invalidation strategy)
- Maintain verbosity selection during slide navigation
- File format v2 with optional verbosityCache field (no migration logic needed)

**Issues Resolved:**
- TypeScript isolatedModules error with VerbosityLevel export (fixed to export type)
- Navigation persistence added in Phase 28 (improved on Phase 27 reset behavior)

**Issues Deferred:**
None

**Technical Debt Incurred:**
None - both phases completed cleanly with no stubs, TODOs, or deferred items.

---

_For current project status, see .planning/ROADMAP.md_
