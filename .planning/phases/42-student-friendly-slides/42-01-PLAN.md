---
phase: 42-student-friendly-slides
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - services/prompts/studentFriendlyRules.ts
  - services/aiProvider.ts
  - App.tsx
autonomous: true

must_haves:
  truths:
    - "GenerationInput interface includes gradeLevel field"
    - "gradeLevel flows from App.tsx to provider.generateLessonSlides()"
    - "Student-friendly prompt rules exist as shared constant"
  artifacts:
    - path: "services/prompts/studentFriendlyRules.ts"
      provides: "Shared student-friendly content rules"
      exports: ["getStudentFriendlyRules"]
    - path: "services/aiProvider.ts"
      provides: "GenerationInput with gradeLevel"
      contains: "gradeLevel?: string"
    - path: "App.tsx"
      provides: "gradeLevel passed in GenerationInput"
      contains: "gradeLevel:"
  key_links:
    - from: "App.tsx"
      to: "GenerationInput"
      via: "gradeLevel property"
      pattern: "gradeLevel:"
    - from: "services/prompts/studentFriendlyRules.ts"
      to: "both providers"
      via: "import"
      pattern: "getStudentFriendlyRules"
---

<objective>
Create shared student-friendly prompt rules and extend GenerationInput to accept gradeLevel.

Purpose: This foundation plan creates the shared prompt rules that transform AI output from teacher-facing notes to student-directed content, and wires gradeLevel through the generation pipeline so providers can adapt vocabulary complexity.

Output: Shared studentFriendlyRules.ts module, extended GenerationInput interface, and App.tsx passing gradeLevel.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/42-student-friendly-slides/42-CONTEXT.md
@.planning/phases/42-student-friendly-slides/42-RESEARCH.md
@services/aiProvider.ts
@App.tsx
@types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared student-friendly prompt rules</name>
  <files>services/prompts/studentFriendlyRules.ts</files>
  <action>
Create a new file `services/prompts/studentFriendlyRules.ts` with a function that returns the student-friendly content rules:

```typescript
/**
 * Student-friendly content rules for AI slide generation.
 * Applied to slide content (bullet points) - NOT to speakerNotes (teleprompter).
 */
export function getStudentFriendlyRules(gradeLevel: string = 'Year 6'): string {
  return `
SLIDE CONTENT STYLE - STUDENT-FACING:
Write bullet points as conversational sentences directed at students, not teacher notes.
Target audience: ${gradeLevel} students.

TONE:
- Clear instructor tone - direct but approachable ("This is...", "Remember that...")
- Address students with "you" sometimes, mix with neutral phrasing
- Balanced voice - not too casual (no slang), not too dry (keep warmth)
- Consistent tone throughout all slides

VOCABULARY:
- Adapt complexity to ${gradeLevel} level
- For technical terms: use term + explanation pattern ("Photosynthesis - how plants make food")
- Sentence structure stays similar across ages, vocabulary complexity changes

CONTENT FORMAT:
- Bullet points must be complete sentences, not fragments
- Questions to students: rarely, only when content naturally calls for reflection
- Include calls-to-action when they enhance understanding

TRANSFORMATION:
- Teacher instructions ("Explain X") - transform to student-facing explanation of X
- Third-person ("students will learn...") - rephrase based on context
- Teacher references in content - keep when natural, rephrase when awkward

NOTE: These rules apply to the 'content' array (bullet points visible to students).
Speaker notes remain teacher-facing for teleprompter use.
`;
}
```

Create the `services/prompts/` directory if it does not exist.
  </action>
  <verify>
File exists: `ls services/prompts/studentFriendlyRules.ts`
TypeScript compiles: `npx tsc --noEmit services/prompts/studentFriendlyRules.ts`
  </verify>
  <done>
studentFriendlyRules.ts exports getStudentFriendlyRules function that returns prompt rules with gradeLevel interpolated.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extend GenerationInput with gradeLevel and wire through App.tsx</name>
  <files>services/aiProvider.ts, App.tsx</files>
  <action>
1. In `services/aiProvider.ts`, add `gradeLevel` to the `GenerationInput` interface:

```typescript
export interface GenerationInput {
  lessonText: string;
  lessonImages?: string[];
  presentationText?: string;
  presentationImages?: string[];
  mode: GenerationMode;
  verbosity?: VerbosityLevel;
  gradeLevel?: string;  // NEW: e.g., "Year 6 (10-11 years old)"
}
```

2. In `App.tsx`, find where `generationInput` is constructed (around line 455) and add `gradeLevel`:

```typescript
const generationInput: GenerationInput = {
  lessonText: lessonText,
  lessonImages: pageImages.length > 0 ? pageImages : undefined,
  presentationText: existingPptText || undefined,
  presentationImages: existingPptImages.length > 0 ? existingPptImages : undefined,
  mode: generationMode,
  verbosity: deckVerbosity,
  gradeLevel: 'Year 6 (10-11 years old)',  // NEW: Default grade level
};
```

Note: The gradeLevel is hardcoded to "Year 6 (10-11 years old)" for now. LessonPlan.gradeLevel exists in types.ts but is not currently populated from any UI. This default satisfies SLIDE-03 (student-friendly style applies automatically). Future phases can add a grade level selector.
  </action>
  <verify>
TypeScript compiles without errors: `npx tsc --noEmit`
Grep confirms gradeLevel in interface: `grep -n "gradeLevel" services/aiProvider.ts`
Grep confirms gradeLevel in App.tsx: `grep -n "gradeLevel" App.tsx`
  </verify>
  <done>
GenerationInput includes gradeLevel field. App.tsx passes gradeLevel: 'Year 6 (10-11 years old)' in generationInput. TypeScript compiles without errors.
  </done>
</task>

</tasks>

<verification>
1. File structure: `ls services/prompts/` shows studentFriendlyRules.ts
2. TypeScript compiles: `npx tsc --noEmit` exits 0
3. GenerationInput has gradeLevel: `grep "gradeLevel" services/aiProvider.ts`
4. App.tsx passes gradeLevel: `grep "gradeLevel" App.tsx`
</verification>

<success_criteria>
- [ ] services/prompts/studentFriendlyRules.ts exists with getStudentFriendlyRules function
- [ ] GenerationInput interface includes gradeLevel?: string field
- [ ] App.tsx constructs generationInput with gradeLevel property
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/42-student-friendly-slides/42-01-SUMMARY.md`
</output>
