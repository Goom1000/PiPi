---
phase: 16-question-enhancement
plan: 02
type: execute
wave: 2
depends_on: ["16-01"]
files_modified:
  - components/PresentationView.tsx
autonomous: true

must_haves:
  truths:
    - "Five difficulty buttons (A B C D E) visible in teleprompter"
    - "Buttons have color gradient (A=rose through E=emerald)"
    - "Generated answer appears below question in teleprompter"
    - "Answer shows bolded key points using MarkdownText"
    - "Question clears on slide change"
  artifacts:
    - path: "components/PresentationView.tsx"
      provides: "Updated question buttons and display"
      contains: "generateQuestionWithAnswer"
  key_links:
    - from: "components/PresentationView.tsx"
      to: "services/aiProvider.ts"
      via: "provider.generateQuestionWithAnswer"
      pattern: "provider\\.generateQuestionWithAnswer"
    - from: "components/PresentationView.tsx"
      to: "components/SlideRenderers.tsx"
      via: "MarkdownText for answer"
      pattern: "MarkdownText.*answer"
---

<objective>
Update PresentationView to show five difficulty buttons and display answers with bolded key points.

Purpose: Teachers need to see both the question and expected answer in the teleprompter, with five difficulty levels matching the grade system (A/B/C/D/E).

Output: Updated teleprompter UI with 5 buttons, question+answer display, and proper color coding.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/16-question-enhancement/16-CONTEXT.md
@.planning/phases/16-question-enhancement/16-RESEARCH.md
@.planning/phases/16-question-enhancement/16-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update question state and handler to use new API</name>
  <files>components/PresentationView.tsx</files>
  <action>
1. Update state type for quickQuestion (around line 250):
   Change from:
   ```typescript
   const [quickQuestion, setQuickQuestion] = useState<{text: string, level: string} | null>(null);
   ```
   To:
   ```typescript
   const [quickQuestion, setQuickQuestion] = useState<{
     question: string;
     answer: string;
     level: string;
   } | null>(null);
   ```

2. Update `handleGenerateQuestion` function (around line 346):
   Change signature to accept 5 levels:
   ```typescript
   const handleGenerateQuestion = async (level: 'A' | 'B' | 'C' | 'D' | 'E') => {
   ```

   Update the body to:
   - Call `provider.generateQuestionWithAnswer(currentSlide.title, currentSlide.content, level)` instead of old method
   - Store result as `{question: result.question, answer: result.answer, level: `Grade ${level}`}`
   - Keep existing error handling pattern with AIProviderError check
   - Keep the `onRequestAI` fallback when no provider

Note: The existing useEffect that clears quickQuestion on slide change (line 287-289) stays unchanged.
  </action>
  <verify>TypeScript compiles: `cd "/Users/ricky/Documents/App_Projects/Education Apps/DEV - PiPi" && npx tsc --noEmit`</verify>
  <done>Question state includes answer field, handler calls new API with 5-level support</done>
</task>

<task type="auto">
  <name>Task 2: Expand buttons from 3 to 5 and update display</name>
  <files>components/PresentationView.tsx</files>
  <action>
1. Update the button grid (around line 713):
   Change from `grid-cols-3` to `grid-cols-5`

2. Replace the three existing buttons with five:
   - Grade A: `bg-rose-800/50 hover:bg-rose-700 text-rose-200 border-rose-700/50` (hardest, warm)
   - Grade B: `bg-orange-800/50 hover:bg-orange-700 text-orange-200 border-orange-700/50`
   - Grade C: `bg-amber-800/50 hover:bg-amber-700 text-amber-200 border-amber-700/50`
   - Grade D: `bg-green-800/50 hover:bg-green-700 text-green-200 border-green-700/50`
   - Grade E: `bg-emerald-800/50 hover:bg-emerald-700 text-emerald-200 border-emerald-700/50` (easiest, cool)

   Each button:
   - onClick calls `handleGenerateQuestion` with corresponding level ('A', 'B', 'C', 'D', 'E')
   - Text: Just the letter "A", "B", "C", "D", "E" (compact, per CONTEXT.md)
   - Same lock icon overlay pattern for when AI unavailable
   - Same disabled title hint

3. Update the question display section (around line 777-790):
   Change from:
   ```tsx
   <p className="text-sm font-medium text-white leading-relaxed mt-1">"{quickQuestion.text}"</p>
   ```
   To:
   ```tsx
   {/* Question */}
   <p className="text-sm font-medium text-white leading-relaxed">
     Q: "{quickQuestion.question}"
   </p>

   {/* Expected Answer - Teacher Only */}
   <div className="border-t border-slate-600 pt-2 mt-2">
     <span className="text-[9px] font-bold text-indigo-400 uppercase tracking-widest block mb-1">
       Expected Answer
     </span>
     <p className="text-sm text-slate-300 leading-relaxed">
       <MarkdownText text={quickQuestion.answer} />
     </p>
   </div>
   ```

4. Update the level badge color mapping (inside the display section):
   ```typescript
   const levelColors: Record<string, string> = {
     'Grade A': 'bg-rose-900 text-rose-300',
     'Grade B': 'bg-orange-900 text-orange-300',
     'Grade C': 'bg-amber-900 text-amber-300',
     'Grade D': 'bg-green-900 text-green-300',
     'Grade E': 'bg-emerald-900 text-emerald-300',
   };
   ```
   Use this in the badge: `className={levelColors[quickQuestion.level] || 'bg-slate-700 text-slate-300'}`
  </action>
  <verify>
1. TypeScript compiles: `cd "/Users/ricky/Documents/App_Projects/Education Apps/DEV - PiPi" && npx tsc --noEmit`
2. Manual test: Run `npm run dev`, enter presentation mode, verify 5 buttons visible
3. Manual test: Click a button, verify question AND answer appear
  </verify>
  <done>
- Five buttons (A B C D E) with color gradient visible in teleprompter
- Question display shows both question and expected answer
- Answer rendered with MarkdownText for bold key points
- Level badge colors match button colors
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Five buttons visible in teleprompter during presentation
3. Clicking a button generates question with answer
4. Answer shows **bold** text properly rendered
5. Different difficulty levels generate appropriate questions
</verification>

<success_criteria>
1. Five difficulty buttons (A/B/C/D/E) visible in teleprompter
2. Buttons have visual gradient (A=hardest/rose through E=easiest/emerald)
3. Clicking button shows question AND expected answer
4. Answer displays with bolded key points (MarkdownText rendering)
5. Question clears when navigating to new slide
6. Existing lock icon behavior preserved when AI unavailable
</success_criteria>

<output>
After completion, create `.planning/phases/16-question-enhancement/16-02-SUMMARY.md`
</output>
