---
phase: 20-game-foundation
plan: 02
type: execute
wave: 2
depends_on: ["20-01"]
files_modified:
  - components/games/GameContainer.tsx
  - components/games/QuickQuizGame.tsx
  - components/games/MillionaireGame.tsx
  - components/games/TheChaseGame.tsx
  - components/games/BeatTheChaserGame.tsx
  - components/games/shared/GameSplash.tsx
  - components/games/shared/ResultScreen.tsx
autonomous: true

must_haves:
  truths:
    - "GameContainer routes to correct game component based on gameType"
    - "QuickQuizGame renders identical to current QuizOverlay play mode"
    - "Placeholder games show splash screen with 'Coming Soon' message"
    - "Result screen displays when game status is 'result'"
    - "Splash screen shows game branding during initialization"
  artifacts:
    - path: "components/games/GameContainer.tsx"
      provides: "Routes to correct game view based on GameState"
      exports: ["GameContainer"]
    - path: "components/games/QuickQuizGame.tsx"
      provides: "Quick Quiz gameplay (refactored from QuizOverlay)"
      exports: ["QuickQuizGame"]
    - path: "components/games/MillionaireGame.tsx"
      provides: "Millionaire placeholder"
      exports: ["MillionaireGame"]
    - path: "components/games/TheChaseGame.tsx"
      provides: "The Chase placeholder"
      exports: ["TheChaseGame"]
    - path: "components/games/BeatTheChaserGame.tsx"
      provides: "Beat the Chaser placeholder"
      exports: ["BeatTheChaserGame"]
    - path: "components/games/shared/GameSplash.tsx"
      provides: "Game branding splash screen"
      exports: ["GameSplash"]
    - path: "components/games/shared/ResultScreen.tsx"
      provides: "End-of-game results display"
      exports: ["ResultScreen"]
  key_links:
    - from: "components/games/GameContainer.tsx"
      to: "types.ts"
      via: "GameState discriminant switch"
      pattern: "switch.*gameType"
    - from: "components/games/QuickQuizGame.tsx"
      to: "components/games/shared/ResultScreen.tsx"
      via: "result status rendering"
      pattern: "status.*===.*'result'"
---

<objective>
Create GameContainer router and refactor Quick Quiz to new architecture with placeholder games.

Purpose: Establish the routing layer that directs to correct game component based on discriminated union, and prove the framework by refactoring the existing quiz.

Output:
- GameContainer.tsx that switches on gameType to render correct game
- QuickQuizGame.tsx refactored from QuizOverlay gameplay logic
- Placeholder components for Millionaire, The Chase, Beat the Chaser (show splash + coming soon)
- Shared GameSplash and ResultScreen components
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/20-game-foundation/20-CONTEXT.md
@.planning/phases/20-game-foundation/20-RESEARCH.md
@.planning/phases/20-game-foundation/20-01-SUMMARY.md
@types.ts
@components/PresentationView.tsx (QuizOverlay component reference)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared game UI components</name>
  <files>components/games/shared/GameSplash.tsx, components/games/shared/ResultScreen.tsx</files>
  <action>
Create directory `components/games/shared/` and add two shared components:

**GameSplash.tsx** - Displays game branding during initialization:
```typescript
import React from 'react';
import { GameType } from '../../../types';

interface GameSplashProps {
  gameType: GameType;
  onContinue?: () => void;
}

const gameConfig: Record<GameType, { icon: string; name: string; tagline: string; bgColor: string }> = {
  'quick-quiz': {
    icon: 'üéØ',
    name: 'Quick Quiz',
    tagline: 'Test your knowledge!',
    bgColor: 'from-indigo-600 to-purple-700',
  },
  'millionaire': {
    icon: 'üí∞',
    name: 'Who Wants to Be a Millionaire',
    tagline: 'Answer 15 questions to win it all!',
    bgColor: 'from-blue-900 to-indigo-900',
  },
  'the-chase': {
    icon: 'üèÉ',
    name: 'The Chase',
    tagline: 'Can you outrun the Chaser?',
    bgColor: 'from-slate-800 to-slate-900',
  },
  'beat-the-chaser': {
    icon: '‚ö°',
    name: 'Beat the Chaser',
    tagline: 'Race against time!',
    bgColor: 'from-amber-600 to-orange-700',
  },
};

const GameSplash: React.FC<GameSplashProps> = ({ gameType, onContinue }) => {
  const config = gameConfig[gameType];

  return (
    <div className={`h-full w-full bg-gradient-to-br ${config.bgColor} flex flex-col items-center justify-center font-poppins animate-fade-in`}>
      <div className="text-9xl mb-8 animate-bounce">{config.icon}</div>
      <h1 className="text-5xl md:text-6xl font-black text-white mb-4 text-center px-8 drop-shadow-lg">
        {config.name}
      </h1>
      <p className="text-xl md:text-2xl text-white/80 mb-12">{config.tagline}</p>
      {onContinue && (
        <button
          onClick={onContinue}
          className="px-10 py-4 bg-white text-slate-900 font-bold text-xl rounded-2xl
            shadow-xl hover:scale-105 transition-transform uppercase tracking-wider"
        >
          Let's Go!
        </button>
      )}
    </div>
  );
};

export default GameSplash;
```

**ResultScreen.tsx** - Displays when game ends:
```typescript
import React from 'react';
import { GameType } from '../../../types';

interface ResultScreenProps {
  gameType: GameType;
  onClose: () => void;
  onRestart?: () => void;
}

const ResultScreen: React.FC<ResultScreenProps> = ({ gameType, onClose, onRestart }) => {
  return (
    <div className="h-full w-full bg-slate-900 flex flex-col items-center justify-center font-poppins animate-fade-in">
      <div className="text-8xl mb-6 animate-bounce">üèÜ</div>
      <h2 className="text-5xl font-black text-white mb-4">Game Complete!</h2>
      <p className="text-2xl text-indigo-200 mb-10">Great job reviewing the lesson.</p>
      <div className="flex gap-4">
        {onRestart && (
          <button
            onClick={onRestart}
            className="px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-xl
              rounded-2xl shadow-xl transition-colors uppercase tracking-wider"
          >
            Play Again
          </button>
        )}
        <button
          onClick={onClose}
          className="px-10 py-4 bg-white text-slate-900 font-bold text-xl rounded-2xl
            shadow-xl hover:scale-105 transition-transform"
        >
          Back to Lesson
        </button>
      </div>
    </div>
  );
};

export default ResultScreen;
```
  </action>
  <verify>Files exist at components/games/shared/GameSplash.tsx and ResultScreen.tsx</verify>
  <done>GameSplash and ResultScreen shared components created</done>
</task>

<task type="auto">
  <name>Task 2: Create QuickQuizGame and placeholder game components</name>
  <files>components/games/QuickQuizGame.tsx, components/games/MillionaireGame.tsx, components/games/TheChaseGame.tsx, components/games/BeatTheChaserGame.tsx</files>
  <action>
Create game components in `components/games/`:

**QuickQuizGame.tsx** - Extract play/reveal/result logic from QuizOverlay:
```typescript
import React from 'react';
import { QuickQuizState } from '../../types';
import ResultScreen from './shared/ResultScreen';

interface QuickQuizGameProps {
  state: QuickQuizState;
  onRevealAnswer: () => void;
  onNextQuestion: () => void;
  onClose: () => void;
  onRestart?: () => void;
}

const QuickQuizGame: React.FC<QuickQuizGameProps> = ({
  state,
  onRevealAnswer,
  onNextQuestion,
  onClose,
  onRestart,
}) => {
  const { questions, currentQuestionIndex, isAnswerRevealed, status } = state;
  const currentQuestion = questions[currentQuestionIndex];

  // Shape renderer (Kahoot-style)
  const renderShape = (idx: number) => {
    const classes = "w-6 h-6 md:w-10 md:h-10 text-white/80";
    if (idx === 0) return <svg className={classes} viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 22h20L12 2z"/></svg>;
    if (idx === 1) return <svg className={classes} viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l10 10-10 10L2 12 12 2z"/></svg>;
    if (idx === 2) return <svg className={classes} viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10"/></svg>;
    return <svg className={classes} viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="18" height="18"/></svg>;
  };

  const bgColors = [
    "bg-red-600 border-red-800",
    "bg-blue-600 border-blue-800",
    "bg-amber-500 border-amber-700",
    "bg-green-600 border-green-800"
  ];

  // Result screen
  if (status === 'result') {
    return <ResultScreen gameType="quick-quiz" onClose={onClose} onRestart={onRestart} />;
  }

  // Play mode
  return (
    <div className="w-full h-full flex flex-col justify-between py-6 px-6">
      {/* Question header */}
      <div className="text-center mb-6">
        <span className="inline-block px-4 py-1 bg-white/10 rounded-full text-sm font-bold uppercase tracking-widest mb-4 text-white">
          Question {currentQuestionIndex + 1} of {questions.length}
        </span>
        <div className="bg-white text-slate-900 p-8 md:p-12 rounded-3xl shadow-2xl text-2xl md:text-4xl font-bold leading-tight min-h-[200px] flex items-center justify-center border-b-8 border-slate-200">
          {currentQuestion.question}
        </div>
      </div>

      {/* Answer options grid */}
      <div className="grid grid-cols-2 gap-4 md:gap-6 flex-1 min-h-0">
        {currentQuestion.options.map((opt, idx) => {
          const isCorrect = idx === currentQuestion.correctAnswerIndex;
          const isDimmed = isAnswerRevealed && !isCorrect;

          return (
            <div
              key={idx}
              className={`
                relative rounded-2xl p-6 md:p-8 flex items-center shadow-lg border-b-8 transition-all duration-500
                ${bgColors[idx]}
                ${isDimmed ? 'opacity-20 grayscale' : 'opacity-100'}
                ${isAnswerRevealed && isCorrect ? 'animate-flash-correct' : ''}
              `}
            >
              <div className="absolute top-4 left-4 opacity-50">{renderShape(idx)}</div>
              <span className="text-xl md:text-3xl font-bold text-white pl-12 md:pl-16 drop-shadow-md">
                {opt}
              </span>
              {isAnswerRevealed && isCorrect && (
                <div className="absolute right-4 top-1/2 -translate-y-1/2 bg-white text-green-600 p-2 rounded-full shadow-lg">
                  <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={4} d="M5 13l4 4L19 7" />
                  </svg>
                </div>
              )}
            </div>
          );
        })}
      </div>

      {/* Controls */}
      <div className="mt-8 flex justify-center gap-4">
        {!isAnswerRevealed ? (
          <button
            onClick={onRevealAnswer}
            className="px-8 py-3 bg-white text-indigo-900 font-bold text-xl rounded-full shadow-lg hover:scale-105 transition-transform"
          >
            Reveal Answer
          </button>
        ) : (
          <div className="flex items-center gap-6 animate-fade-in w-full max-w-4xl">
            <div className="flex-1 bg-indigo-900/50 p-4 rounded-xl border border-indigo-500/30">
              <span className="text-xs font-bold text-indigo-300 uppercase block mb-1">Explanation</span>
              <p className="text-lg text-white">{currentQuestion.explanation}</p>
            </div>
            <button
              onClick={onNextQuestion}
              className="px-8 py-4 bg-indigo-500 hover:bg-indigo-400 text-white font-bold text-xl rounded-2xl border-b-4 border-indigo-700 active:translate-y-1 active:border-b-0 transition-all shrink-0"
            >
              {currentQuestionIndex < questions.length - 1 ? 'Next Question ‚ûî' : 'Finish'}
            </button>
          </div>
        )}
      </div>
    </div>
  );
};

export default QuickQuizGame;
```

**MillionaireGame.tsx** - Placeholder:
```typescript
import React from 'react';
import { MillionaireState } from '../../types';
import GameSplash from './shared/GameSplash';

interface MillionaireGameProps {
  state: MillionaireState;
  onClose: () => void;
}

const MillionaireGame: React.FC<MillionaireGameProps> = ({ state, onClose }) => {
  return (
    <div className="w-full h-full relative">
      <GameSplash gameType="millionaire" />
      <div className="absolute inset-0 flex items-center justify-center bg-black/60">
        <div className="text-center">
          <p className="text-3xl font-bold text-white mb-4">Coming in Phase 21</p>
          <button
            onClick={onClose}
            className="px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:scale-105 transition-transform"
          >
            Back to Lesson
          </button>
        </div>
      </div>
    </div>
  );
};

export default MillionaireGame;
```

**TheChaseGame.tsx** - Placeholder:
```typescript
import React from 'react';
import { TheChaseState } from '../../types';
import GameSplash from './shared/GameSplash';

interface TheChaseGameProps {
  state: TheChaseState;
  onClose: () => void;
}

const TheChaseGame: React.FC<TheChaseGameProps> = ({ state, onClose }) => {
  return (
    <div className="w-full h-full relative">
      <GameSplash gameType="the-chase" />
      <div className="absolute inset-0 flex items-center justify-center bg-black/60">
        <div className="text-center">
          <p className="text-3xl font-bold text-white mb-4">Coming in Phase 23</p>
          <button
            onClick={onClose}
            className="px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:scale-105 transition-transform"
          >
            Back to Lesson
          </button>
        </div>
      </div>
    </div>
  );
};

export default TheChaseGame;
```

**BeatTheChaserGame.tsx** - Placeholder:
```typescript
import React from 'react';
import { BeatTheChaserState } from '../../types';
import GameSplash from './shared/GameSplash';

interface BeatTheChaserGameProps {
  state: BeatTheChaserState;
  onClose: () => void;
}

const BeatTheChaserGame: React.FC<BeatTheChaserGameProps> = ({ state, onClose }) => {
  return (
    <div className="w-full h-full relative">
      <GameSplash gameType="beat-the-chaser" />
      <div className="absolute inset-0 flex items-center justify-center bg-black/60">
        <div className="text-center">
          <p className="text-3xl font-bold text-white mb-4">Coming in Phase 24</p>
          <button
            onClick={onClose}
            className="px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:scale-105 transition-transform"
          >
            Back to Lesson
          </button>
        </div>
      </div>
    </div>
  );
};

export default BeatTheChaserGame;
```
  </action>
  <verify>All 4 game component files exist in components/games/</verify>
  <done>QuickQuizGame with full gameplay and 3 placeholder game components created</done>
</task>

<task type="auto">
  <name>Task 3: Create GameContainer router component</name>
  <files>components/games/GameContainer.tsx</files>
  <action>
Create `components/games/GameContainer.tsx` - the routing layer that switches based on gameType discriminant:

```typescript
import React from 'react';
import { GameState, assertNever } from '../../types';
import GameSplash from './shared/GameSplash';
import QuickQuizGame from './QuickQuizGame';
import MillionaireGame from './MillionaireGame';
import TheChaseGame from './TheChaseGame';
import BeatTheChaserGame from './BeatTheChaserGame';

interface GameContainerProps {
  state: GameState;
  onClose: () => void;
  onRevealAnswer: () => void;
  onNextQuestion: () => void;
  onRestart?: () => void;
}

/**
 * Routes to the correct game component based on the discriminated union gameType.
 * Uses exhaustive switch to ensure all game types are handled.
 */
const GameContainer: React.FC<GameContainerProps> = ({
  state,
  onClose,
  onRevealAnswer,
  onNextQuestion,
  onRestart,
}) => {
  // Show splash screen during loading
  if (state.status === 'loading' || state.status === 'splash') {
    return (
      <div className="h-full w-full">
        <GameSplash
          gameType={state.gameType}
          onContinue={state.status === 'splash' ? undefined : undefined}
        />
        {state.status === 'loading' && (
          <div className="absolute inset-0 flex items-center justify-center bg-black/40">
            <div className="text-center">
              <div className="relative w-20 h-20 mx-auto mb-6">
                <div className="absolute inset-0 border-8 border-white/20 rounded-full"></div>
                <div className="absolute inset-0 border-8 border-t-white border-l-transparent border-r-transparent border-b-transparent rounded-full animate-spin"></div>
              </div>
              <p className="text-xl text-white font-bold animate-pulse">Generating Questions...</p>
            </div>
          </div>
        )}
      </div>
    );
  }

  // Route to correct game component based on gameType discriminant
  switch (state.gameType) {
    case 'quick-quiz':
      return (
        <QuickQuizGame
          state={state}
          onRevealAnswer={onRevealAnswer}
          onNextQuestion={onNextQuestion}
          onClose={onClose}
          onRestart={onRestart}
        />
      );

    case 'millionaire':
      return (
        <MillionaireGame
          state={state}
          onClose={onClose}
        />
      );

    case 'the-chase':
      return (
        <TheChaseGame
          state={state}
          onClose={onClose}
        />
      );

    case 'beat-the-chaser':
      return (
        <BeatTheChaserGame
          state={state}
          onClose={onClose}
        />
      );

    default:
      // TypeScript will error here if a case is missed
      return assertNever(state);
  }
};

export default GameContainer;
```

Key implementation notes:
- Uses discriminated union switch for type-safe routing
- assertNever in default case ensures exhaustive handling
- Loading/splash status handled at container level (shows GameSplash)
- Each game component receives type-narrowed state
  </action>
  <verify>Run `npx tsc --noEmit` to verify types compile and exhaustive switch is correct</verify>
  <done>GameContainer routes to correct game based on gameType discriminant with exhaustive switch</done>
</task>

</tasks>

<verification>
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] components/games/shared/GameSplash.tsx exists and handles all 4 game types
- [ ] components/games/shared/ResultScreen.tsx exists
- [ ] components/games/QuickQuizGame.tsx exists with full gameplay UI
- [ ] components/games/MillionaireGame.tsx exists as placeholder
- [ ] components/games/TheChaseGame.tsx exists as placeholder
- [ ] components/games/BeatTheChaserGame.tsx exists as placeholder
- [ ] components/games/GameContainer.tsx exists with exhaustive switch
</verification>

<success_criteria>
- TypeScript compiles without errors
- GameContainer uses discriminated union switch with assertNever
- QuickQuizGame renders question, options, reveal, and controls
- Placeholder games show splash screen with "Coming in Phase N" overlay
- Shared GameSplash and ResultScreen work for all game types
</success_criteria>

<output>
After completion, create `.planning/phases/20-game-foundation/20-02-SUMMARY.md`
</output>
