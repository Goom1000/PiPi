---
phase: 19-rebrand-to-cue
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - index.html
  - App.tsx
  - types.ts
  - services/saveService.ts
  - services/loadService.ts
  - hooks/useDragDrop.ts
  - components/ResourceHub.tsx
  - services/geminiService.ts
  - services/providers/claudeProvider.ts
autonomous: true

must_haves:
  truths:
    - "User sees 'Cue' in browser tab title"
    - "User sees 'Cue' in app header"
    - "User sees 'Cue' on landing page"
    - "User sees Cue favicon in browser tab"
    - "User can save presentations as .cue files"
    - "User can load existing .pipi files without errors"
    - "Drag-and-drop accepts both .cue and .pipi files"
  artifacts:
    - path: "index.html"
      provides: "Browser tab title and favicon path"
      contains: "<title>Cue</title>"
    - path: "App.tsx"
      provides: "UI branding in header and landing"
      contains: ">Cue<"
    - path: "types.ts"
      provides: "CueFile and CueFileContent type definitions"
      contains: "interface CueFile"
    - path: "services/saveService.ts"
      provides: "Save function with .cue extension"
      contains: ".cue"
    - path: "services/loadService.ts"
      provides: "Load function accepting .cue and .pipi"
      contains: ".cue"
  key_links:
    - from: "App.tsx"
      to: "services/saveService.ts"
      via: "createCueFile import"
      pattern: "import.*createCueFile.*from.*saveService"
    - from: "App.tsx"
      to: "services/loadService.ts"
      via: "readCueFile import"
      pattern: "import.*readCueFile.*from.*loadService"
    - from: "services/loadService.ts"
      to: "types.ts"
      via: "CueFile type import"
      pattern: "import.*CueFile.*from.*types"
---

<objective>
Rebrand all user-visible UI from "PiPi" to "Cue" and migrate file format from .pipi to .cue extension with backward compatibility.

Purpose: Complete the v2.5 rebrand by updating all UI text, file format handling, and branding references so users see "Cue" throughout the application.

Output: All UI displays "Cue", saves use .cue extension, loads accept both .cue and legacy .pipi files.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/19-rebrand-to-cue/19-RESEARCH.md
@index.html
@App.tsx
@types.ts
@services/saveService.ts
@services/loadService.ts
@hooks/useDragDrop.ts
@components/ResourceHub.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update UI branding strings and favicon</name>
  <files>
    - index.html
    - App.tsx
    - components/ResourceHub.tsx
    - services/geminiService.ts
    - services/providers/claudeProvider.ts
  </files>
  <action>
Update all user-visible "PiPi" strings to "Cue" and update favicon reference:

1. **index.html:**
   - Line 7: Change `<title>PiPi</title>` to `<title>Cue</title>`
   - Line 8: Change favicon href from `/PiPi/favicon.png` to relative path `./favicon.png`
     (This ensures favicon works in both dev and production regardless of base path)

2. **App.tsx:**
   - Line 755: Change header logo text from "PiPi" to "Cue"
   - Line 855: Change landing page logo text from "PiPi" to "Cue"

3. **components/ResourceHub.tsx:**
   - Line 160: Change "Created with PiPi" to "Created with Cue"
   - Line 376: Change footer "PiPi" to "Cue"

4. **services/geminiService.ts:**
   - Lines 53, 60, 65, 86, 120, 122: Change "PiPi-style" to "Cue-style" in AI prompts

5. **services/providers/claudeProvider.ts:**
   - Lines 66, 73, 78, 101, 252, 257: Change "PiPi-style" to "Cue-style" in AI prompts

**Note about favicon asset (BRAND-03):** The existing `/public/favicon.png` file will remain as the favicon image. Since the favicon does not contain "PiPi" text (it's an icon graphic), no image replacement is needed. Only the href path in index.html needs updating to use a relative path.

**Do NOT change:**
- localStorage keys (pipi-class-bank, pipi-settings, etc.) - internal, not user-visible
- BroadcastChannel name (pipi-presentation) - internal sync mechanism
- Any import statements or type names (handled in Task 2)
  </action>
  <verify>
1. Run: `grep -r "PiPi" index.html App.tsx components/ResourceHub.tsx services/geminiService.ts services/providers/claudeProvider.ts --include="*.tsx" --include="*.ts" --include="*.html" | grep -v "pipi-" | grep -v ".pipi"`
   Should return no matches (excluding internal keys and file extensions which are handled in Task 2).
2. Verify favicon uses relative path: `grep "favicon" index.html`
   Should show `href="./favicon.png"` (no /PiPi/ prefix).
  </verify>
  <done>Browser tab shows "Cue" title, favicon loads correctly, header shows "Cue", landing page shows "Cue", AI prompts reference "Cue-style", resource footers show "Cue".</done>
</task>

<task type="auto">
  <name>Task 2: Migrate file format types and functions</name>
  <files>
    - types.ts
    - services/saveService.ts
    - services/loadService.ts
    - hooks/useDragDrop.ts
    - App.tsx
  </files>
  <action>
Rename TypeScript types and update file extension handling for backward compatibility:

1. **types.ts:**
   - Rename `PiPiFileContent` interface to `CueFileContent`
   - Rename `PiPiFile` interface to `CueFile`
   - Update comments from ".pipi" to ".cue" (lines 82, 90, 91)
   - Keep `BROADCAST_CHANNEL_NAME = 'pipi-presentation'` unchanged (internal)

2. **services/saveService.ts:**
   - Update imports: `PiPiFile` -> `CueFile`
   - Rename `createPiPiFile` to `createCueFile`
   - Update JSDoc comments from ".pipi" to ".cue"
   - Line 77: Change extension check from `.pipi` to `.cue`
   - Line 77: Change `${filename}.pipi` to `${filename}.cue`
   - Update `checkFileSize` and `downloadPresentation` parameter types

3. **services/loadService.ts:**
   - Update imports: `PiPiFile` -> `CueFile`
   - Rename `isValidPiPiFile` to `isValidCueFile`
   - Rename `readPiPiFile` to `readCueFile`
   - Update JSDoc comments
   - **Backward compatibility (critical):** Line 73 extension check should accept BOTH:
     ```typescript
     const isValidExtension = file.name.endsWith('.cue') || file.name.endsWith('.pipi');
     if (!isValidExtension) {
       reject(new Error('Invalid file type. Expected .cue or .pipi file.'));
       return;
     }
     ```

4. **hooks/useDragDrop.ts:**
   - Line 39: Update to accept both extensions:
     ```typescript
     const isValidFile = file.name.endsWith('.cue') || file.name.endsWith('.pipi');
     if (isValidFile) {
     ```
   - Update JSDoc comments from ".pipi" to ".cue"

5. **App.tsx:**
   - Update imports: `createPiPiFile` -> `createCueFile`, `readPiPiFile` -> `readCueFile`
   - Line 806: Change `accept=".pipi"` to `accept=".cue,.pipi"` for file input
   - Update all calls: `createPiPiFile(...)` -> `createCueFile(...)`
   - Update all calls: `readPiPiFile(...)` -> `readCueFile(...)`
   - Line 688: Update error message from `.pipi` to `.cue or .pipi`
   - Line 1048: Update hint text from `.pipi` to `.cue`
   - Line 1290: Update file extension display from `.pipi` to `.cue`

**Note on file picker labels (FILE-03):** Browser native file picker dialogs do NOT support custom display labels like "Cue Presentation (*.cue)". The `accept` attribute only filters which files are selectable - the visible file type label in the picker is controlled by the browser/OS and cannot be customized via HTML. Setting `accept=".cue,.pipi"` satisfies the requirement by ensuring users can only select valid file types. This is standard web platform behavior.

**Do NOT change:**
- localStorage keys (keep pipi- prefix for backward compatibility with existing user data)
- BroadcastChannel name (keep for cross-window sync compatibility)
  </action>
  <verify>
1. Run: `npm run typecheck` - should pass with no errors
2. Run: `grep -r "PiPiFile\|PiPiFileContent\|createPiPiFile\|readPiPiFile\|isValidPiPiFile" . --include="*.ts" --include="*.tsx" | grep -v node_modules | grep -v dist`
   Should return no matches.
3. Run: `grep -r "CueFile\|createCueFile\|readCueFile" . --include="*.ts" --include="*.tsx" | grep -v node_modules | grep -v dist`
   Should show matches in types.ts, saveService.ts, loadService.ts, App.tsx.
  </verify>
  <done>Types renamed to CueFile/CueFileContent, functions renamed to createCueFile/readCueFile, saves use .cue extension, loads accept both .cue and .pipi for backward compatibility.</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run typecheck` passes
2. `npm run build` succeeds
3. `npm run dev` shows:
   - Browser tab: "Cue" title with favicon
   - Header: "Cue"
   - Landing page: "Cue"
4. Save a presentation: downloads as `.cue` file
5. Load a `.pipi` file: loads successfully (backward compatibility)
6. Load a `.cue` file: loads successfully
7. Drag-drop both file types: both work
8. No "PiPi" visible anywhere in UI (except internal localStorage keys which are invisible to users)
</verification>

<success_criteria>
- All user-visible "PiPi" strings replaced with "Cue"
- Favicon displays correctly (BRAND-03)
- File saves use `.cue` extension
- File loads accept both `.cue` and `.pipi` (backward compatible)
- File picker filters to .cue/.pipi files (FILE-03 - browser native behavior)
- TypeScript compiles without errors
- Build succeeds
- Requirements BRAND-01 through FILE-03 addressed (REPO-01/02 in Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/19-rebrand-to-cue/19-01-SUMMARY.md` documenting:
- Files modified
- Key changes (type renames, extension handling)
- Backward compatibility approach
- Any issues encountered
</output>
